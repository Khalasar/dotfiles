#!/bin/bash

ARCH=$(uname -m)
ARCH_CMD=linux64

uid=$(id -u)
gid=$(id -g)

docker run \
    --rm \
    -it \
    -u $uid:$gid \
    -v $(pwd):/mnt \
    -w /mnt \
    -e LIBRARY_PATH="/opt/crystal/embedded/lib/" \
    -e CRYSTAL_CONFIG_VERSION="ci" \
    "jhass/crystal-build-$ARCH" \
    "$ARCH_CMD" $@
